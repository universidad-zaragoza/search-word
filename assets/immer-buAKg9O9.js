var R=Symbol.for("immer-nothing"),K=Symbol.for("immer-draftable"),s=Symbol.for("immer-state");function f(t,...r){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var h=Object.getPrototypeOf;function _(t){return!!t&&!!t[s]}function l(t){var r;return t?W(t)||Array.isArray(t)||!!t[K]||!!((r=t.constructor)!=null&&r[K])||P(t)||S(t):!1}var V=Object.prototype.constructor.toString();function W(t){if(!t||typeof t!="object")return!1;const r=h(t);if(r===null)return!0;const n=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===V}function b(t,r){g(t)===0?Object.entries(t).forEach(([n,e])=>{r(n,e,t)}):t.forEach((n,e)=>r(e,n,t))}function g(t){const r=t[s];return r?r.type_:Array.isArray(t)?1:P(t)?2:S(t)?3:0}function F(t,r){return g(t)===2?t.has(r):Object.prototype.hasOwnProperty.call(t,r)}function U(t,r,n){const e=g(t);e===2?t.set(r,n):e===3?t.add(n):t[r]=n}function Y(t,r){return t===r?t!==0||1/t===1/r:t!==t&&r!==r}function P(t){return t instanceof Map}function S(t){return t instanceof Set}function p(t){return t.copy_||t.base_}function j(t,r){if(P(t))return new Map(t);if(S(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);if(!r&&W(t))return h(t)?{...t}:Object.assign(Object.create(null),t);const n=Object.getOwnPropertyDescriptors(t);delete n[s];let e=Reflect.ownKeys(n);for(let o=0;o<e.length;o++){const i=e[o],c=n[i];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[i]={configurable:!0,writable:!0,enumerable:c.enumerable,value:t[i]})}return Object.create(h(t),n)}function A(t,r=!1){return w(t)||_(t)||!l(t)||(g(t)>1&&(t.set=t.add=t.clear=t.delete=Z),Object.freeze(t),r&&b(t,(n,e)=>A(e,!0))),t}function Z(){f(2)}function w(t){return Object.isFrozen(t)}var q={};function d(t){const r=q[t];return r||f(0,t),r}var m;function L(){return m}function J(t,r){return{drafts_:[],parent_:t,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function I(t,r){r&&(d("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=r)}function D(t){C(t),t.drafts_.forEach(tt),t.drafts_=null}function C(t){t===m&&(m=t.parent_)}function X(t){return m=J(m,t)}function tt(t){const r=t[s];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function $(t,r){r.unfinalizedDrafts_=r.drafts_.length;const n=r.drafts_[0];return t!==void 0&&t!==n?(n[s].modified_&&(D(r),f(4)),l(t)&&(t=z(r,t),r.parent_||O(r,t)),r.patches_&&d("Patches").generateReplacementPatches_(n[s].base_,t,r.patches_,r.inversePatches_)):t=z(r,n,[]),D(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),t!==R?t:void 0}function z(t,r,n){if(w(r))return r;const e=r[s];if(!e)return b(r,(o,i)=>B(t,e,r,o,i,n)),r;if(e.scope_!==t)return r;if(!e.modified_)return O(t,e.base_,!0),e.base_;if(!e.finalized_){e.finalized_=!0,e.scope_.unfinalizedDrafts_--;const o=e.copy_;let i=o,c=!1;e.type_===3&&(i=new Set(o),o.clear(),c=!0),b(i,(a,y)=>B(t,e,o,a,y,n,c)),O(t,o,!1),n&&t.patches_&&d("Patches").generatePatches_(e,n,t.patches_,t.inversePatches_)}return e.copy_}function B(t,r,n,e,o,i,c){if(_(o)){const a=i&&r&&r.type_!==3&&!F(r.assigned_,e)?i.concat(e):void 0,y=z(t,o,a);if(U(n,e,y),_(y))t.canAutoFreeze_=!1;else return}else c&&n.add(o);if(l(o)&&!w(o)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;z(t,o),(!r||!r.scope_.parent_)&&O(t,o)}}function O(t,r,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&A(r,n)}function rt(t,r){const n=Array.isArray(t),e={type_:n?1:0,scope_:r?r.scope_:L(),modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let o=e,i=M;n&&(o=[e],i=v);const{revoke:c,proxy:a}=Proxy.revocable(o,i);return e.draft_=a,e.revoke_=c,a}var M={get(t,r){if(r===s)return t;const n=p(t);if(!F(n,r))return nt(t,n,r);const e=n[r];return t.finalized_||!l(e)?e:e===k(t.base_,r)?(x(t),t.copy_[r]=E(e,t)):e},has(t,r){return r in p(t)},ownKeys(t){return Reflect.ownKeys(p(t))},set(t,r,n){const e=G(p(t),r);if(e!=null&&e.set)return e.set.call(t.draft_,n),!0;if(!t.modified_){const o=k(p(t),r),i=o==null?void 0:o[s];if(i&&i.base_===n)return t.copy_[r]=n,t.assigned_[r]=!1,!0;if(Y(n,o)&&(n!==void 0||F(t.base_,r)))return!0;x(t),N(t)}return t.copy_[r]===n&&(n!==void 0||r in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[r])||(t.copy_[r]=n,t.assigned_[r]=!0),!0},deleteProperty(t,r){return k(t.base_,r)!==void 0||r in t.base_?(t.assigned_[r]=!1,x(t),N(t)):delete t.assigned_[r],t.copy_&&delete t.copy_[r],!0},getOwnPropertyDescriptor(t,r){const n=p(t),e=Reflect.getOwnPropertyDescriptor(n,r);return e&&{writable:!0,configurable:t.type_!==1||r!=="length",enumerable:e.enumerable,value:n[r]}},defineProperty(){f(11)},getPrototypeOf(t){return h(t.base_)},setPrototypeOf(){f(12)}},v={};b(M,(t,r)=>{v[t]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}}),v.deleteProperty=function(t,r){return v.set.call(this,t,r,void 0)},v.set=function(t,r,n){return M.set.call(this,t[0],r,n,t[0])};function k(t,r){const n=t[s];return(n?p(n):t)[r]}function nt(t,r,n){var o;const e=G(r,n);return e?"value"in e?e.value:(o=e.get)==null?void 0:o.call(t.draft_):void 0}function G(t,r){if(!(r in t))return;let n=h(t);for(;n;){const e=Object.getOwnPropertyDescriptor(n,r);if(e)return e;n=h(n)}}function N(t){t.modified_||(t.modified_=!0,t.parent_&&N(t.parent_))}function x(t){t.copy_||(t.copy_=j(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var et=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(r,n,e)=>{if(typeof r=="function"&&typeof n!="function"){const i=n;n=r;const c=this;return function(a=i,...y){return c.produce(a,T=>n.call(this,T,...y))}}typeof n!="function"&&f(6),e!==void 0&&typeof e!="function"&&f(7);let o;if(l(r)){const i=X(this),c=E(r,void 0);let a=!0;try{o=n(c),a=!1}finally{a?D(i):C(i)}return I(i,e),$(o,i)}else if(!r||typeof r!="object"){if(o=n(r),o===void 0&&(o=r),o===R&&(o=void 0),this.autoFreeze_&&A(o,!0),e){const i=[],c=[];d("Patches").generateReplacementPatches_(r,o,i,c),e(i,c)}return o}else f(1,r)},this.produceWithPatches=(r,n)=>{if(typeof r=="function")return(i,...c)=>this.produceWithPatches(i,a=>r(a,...c));let e,o;return[this.produce(r,n,(i,c)=>{e=i,o=c}),e,o]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){l(t)||f(8),_(t)&&(t=H(t));const r=X(this),n=E(t,void 0);return n[s].isManual_=!0,C(r),n}finishDraft(t,r){const n=t&&t[s];(!n||!n.isManual_)&&f(9);const{scope_:e}=n;return I(e,r),$(void 0,e)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const o=r[n];if(o.path.length===0&&o.op==="replace"){t=o.value;break}}n>-1&&(r=r.slice(n+1));const e=d("Patches").applyPatches_;return _(t)?e(t,r):this.produce(t,o=>e(o,r))}};function E(t,r){const n=P(t)?d("MapSet").proxyMap_(t,r):S(t)?d("MapSet").proxySet_(t,r):rt(t,r);return(r?r.scope_:L()).drafts_.push(n),n}function H(t){return _(t)||f(10,t),Q(t)}function Q(t){if(!l(t)||w(t))return t;const r=t[s];let n;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,n=j(t,r.scope_.immer_.useStrictShallowCopy_)}else n=j(t,!0);return b(n,(e,o)=>{U(n,e,Q(o))}),r&&(r.finalized_=!1),n}var u=new et,ot=u.produce;u.produceWithPatches.bind(u),u.setAutoFreeze.bind(u),u.setUseStrictShallowCopy.bind(u),u.applyPatches.bind(u),u.createDraft.bind(u),u.finishDraft.bind(u);export{l as a,H as c,_ as i,ot as p};
