import{j as e,r as o,R as W}from"./react-ePaza90U.js";import{c as J}from"./react-dom-ClCCcWrb.js";import{B as Q}from"./react-router-dom-DLKOTzUC.js";import{F as q,f as Y,a as X,b as Z}from"./@fortawesome-BDF4bdm0.js";import{u as ee,a as ae,b as M}from"./react-router-DHtK1h3G.js";import{p as se}from"./dompurify-BuFh49mM.js";import{I as te,F as ne}from"./react-bootstrap-BbG3D7e1.js";import{u as S,a as y,P as ie}from"./react-redux-Cys67l4T.js";import{c as re,a as ce}from"./@reduxjs-CJetLCaM.js";import{W as oe,s as le}from"./@arvidbt-_UtwSn1N.js";import{S as de}from"./react-singleton-hook-C2tOxsmn.js";import"./classnames-C9FZUsQl.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-Dql683DL.js";import"./prop-types-ZMHxiqrO.js";import"./use-sync-external-store-R5Bn9tbY.js";import"./redux-DITMfSWq.js";import"./immer-D6jAg06p.js";import"./reselect-DJRGOWkq.js";import"./redux-thunk-ClJT1hhx.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();const me="/",ue="/search-word",ge="/dialog",pe="/debug",I={START_APP_ROUTE:me,BASE_ROUTE:ue,DIALOG_ROUTE:ge,DEBUG_ROUTE:pe},ve=()=>{const a=ee();return{onClickNavigateToPath:t=>{a(t)}}},w=({id:a,classStyle:t,children:i,path:n,type:s,onClick:c})=>{const{onClickNavigateToPath:d}=ve();return e.jsx(e.Fragment,{children:s==="button"&&c?e.jsx("button",{id:a,type:"button",className:"btn btn-active-color "+t,onTouchEnd:c,children:i}):s==="button"&&!c?e.jsx("button",{id:a,type:"button",className:"btn btn-active-color "+t,onTouchEnd:()=>d(n),children:i}):e.jsx("button",{id:a,type:s,className:"btn btn-active-color "+t,children:i})})},H=({navBrand:a,navBtns:t})=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"navbar-wrapper",children:e.jsx("nav",{className:"navbar navbar-custom navbar-expand-sm",children:e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"navbar-brand",children:e.jsx("div",{className:"navbar-brand-grid-container",children:a.name?e.jsx(e.Fragment,{children:e.jsx("div",{className:"nameGrid align-items-center",children:e.jsx("div",{className:"name",children:a.name})})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"onlyIconGrid",children:e.jsx("div",{className:"icon",children:a.icon})})})})}),e.jsx("div",{className:"collapse navbar-collapse",id:"navbarNav",children:e.jsx("div",{className:"navbar-nav ms-auto mb-2 mb-lg-0",children:t.map((i,n)=>e.jsx("div",{className:"nav-btn-item",children:e.jsx(w,{id:i.name,path:i.path,type:"button",children:e.jsx(q,{className:"nav-btn-icon",icon:i.icon})})},n))})})]})})})}),he=a=>({__html:se.sanitize(a)}),xe=({msg:a,icon:t})=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"footer-wrapper",children:e.jsx("div",{className:"footer-custom",children:e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-1 icon",children:e.jsx("div",{children:t})}),e.jsx("div",{className:"col-11 text",children:e.jsx("div",{dangerouslySetInnerHTML:he(a)})})]})})})})}),be="/search-word/assets/avatar-not-speaking-BwFjj1a-.gif",Ne="/search-word/assets/avatar-speaking-DQHi02TP.gif",Se="/search-word/assets/load-icon-4INARmNJ.gif",j={avatarNotSpeakingIcon:{imageSrc:be,imageAlt:"avatar normal",imageAttribution:"Avatar Not Speaking Icon created by Raquel Arcaz Arias",searchLink:""},avatarSpeakingIcon:{imageSrc:Ne,imageAlt:"avatar hablando",imageAttribution:"Avatar Speaking Icon created by Raquel Arcaz Arias",searchLink:""},loadingIcon:{imageSrc:Se,imageAlt:"cargando",imageAttribution:"Avatar Speaking Icon created by Raquel Arcaz Arias",searchLink:""}};var b=(a=>(a.SEND_SPEECH="send-msg",a.START_SPEECH="start-saying-msg",a.END_SPEECH="end-saying-msg",a.NONE="none",a))(b||{}),h=(a=>(a.LOADING="loading",a.OK="ok",a.NOT_OK="not-ok",a))(h||{}),T=(a=>(a.MICROPHONE_OPENED="opened",a.MICROPHONE_CLOSED="closed",a))(T||{});const V={data:{intentType:"",userRequest:""},voiceAPIStatus:h.LOADING,voiceMicroStatus:T.MICROPHONE_CLOSED,voiceMsgProps:{body:"",status:b.NONE},deviceId:"1",processingUserRequest:!1},z=re({name:"voiceState",initialState:V,reducers:{setVoiceAPIStatus:(a,t)=>{a.voiceAPIStatus=t.payload},setVoiceMicroStatus:(a,t)=>{a.voiceMicroStatus=t.payload},setVoiceMsgBody:(a,t)=>{a.voiceMsgProps.body=t.payload},setVoiceMsgStatus:(a,t)=>{a.voiceMsgProps.status=t.payload},setDeviceId:(a,t)=>{a.deviceId=t.payload},setProcessingUserRequest:(a,t)=>{a.processingUserRequest=t.payload},setUserSpeechData:(a,t)=>{a.data=t.payload},resetUserSpeechData:a=>{a.data=V.data}}}),{setVoiceAPIStatus:O,setVoiceMicroStatus:$,setVoiceMsgBody:aa,setVoiceMsgStatus:A,setDeviceId:je,setProcessingUserRequest:F,setUserSpeechData:Ee,resetUserSpeechData:G}=z.actions,Ae=z.reducer,fe=()=>{const a=S(d=>{var m;return(m=d.voiceState)==null?void 0:m.voiceAPIStatus}),t=y(),{printDebug:i,sendTextToAlexa:n}=o.useContext(R),s=async d=>{const m=c(d);await n(a,m),t(F(!1))},c=d=>{let m="<voice name='Lucia'>";return m+=d,m+="</voice>",m};return{speechResponseToUserRequest:s}},ye=(a,t)=>{const i=Array(a.length+1).fill(null).map(()=>Array(t.length+1).fill(0));for(let s=0;s<=a.length;s++)for(let c=0;c<=t.length;c++)s===0?i[s][c]=c:c===0?i[s][c]=s:a[s-1]===t[c-1]?i[s][c]=i[s-1][c-1]:i[s][c]=1+Math.min(i[s-1][c],i[s][c-1],i[s-1][c-1]);const n=Math.max(a.length,t.length);return 1-i[a.length][t.length]/n},Ie=()=>{const a=`<voice name='Lucia'><amazon:emotion name="excited" intensity="high"> 
                          \xA1Hola! Mi nombre es Alexa. D\xEDme una palabra </amazon:emotion><break strength='strong'/></voice>`,[t,i]=o.useState(!1),[n,s]=o.useState(!1),[c,d]=o.useState(!1),[m,u]=o.useState(new oe(le)),[D,P]=o.useState(""),x=S(p=>{var l;return(l=p.voiceState)==null?void 0:l.voiceAPIStatus}),N=S(p=>{var l;return(l=p.voiceState)==null?void 0:l.voiceMsgProps}),k=S(p=>{var l;return(l=p.voiceState)==null?void 0:l.processingUserRequest}),E=S(p=>{var l,v;return(v=(l=p.voiceState)==null?void 0:l.data)==null?void 0:v.intentType}),f=S(p=>{var l,v;return(v=(l=p.voiceState)==null?void 0:l.data)==null?void 0:v.userRequest}),C=y(),{speechResponseToUserRequest:r}=fe(),{printDebug:g}=o.useContext(R),B=o.useCallback(()=>{g(`+++ INSIDE loading() - voiceAPIStatus => ${x}`),g(`+++ INSIDE loading() - voiceMsgStatus => ${N.status}`),x===h.LOADING||k?i(!0):i(!1)},[x,N]),_=o.useCallback(()=>{N.status===b.START_SPEECH?s(!0):s(!1)},[N]),L=o.useCallback(()=>{r(a)},[x]),U=o.useCallback(async()=>{g("+++ INSIDE handleVoiceAPIIntents() +++ "),g(`+++ VOICE API STATUS => ${x} `),g(`+++ INTENT TYPE => ${E} `),E==="word-intent"&&(P(f.toUpperCase()),d(!0),K(f),d(!1)),C(G())},[E,x]),K=p=>{m.getDictionaryWords().map(l=>{const v=ye(l.toLowerCase(),p.toLowerCase());v>=.8&&(console.log(`LVN DISTANCE between ${l} and ${p} is ${v}`),g(`LVN DISTANCE between ${l} and ${p} is ${v}`))})};return o.useEffect(()=>{B()},[B]),o.useEffect(()=>{L()},[L]),o.useEffect(()=>{_()},[_]),o.useEffect(()=>{U()},[U]),{wordToSearch:D,isLoading:t,isSpeechOn:n,isSearchingWord:c}},Te=()=>{const{wordToSearch:a,isLoading:t,isSpeechOn:i,isSearchingWord:n}=Ie();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"container-fluid",children:e.jsx("div",{className:"container-menu",children:e.jsxs("div",{className:"grid-container",children:[i?e.jsx("div",{className:"grid-item item-avatar",children:e.jsx("img",{src:j.avatarSpeakingIcon.imageSrc,alt:j.avatarSpeakingIcon.imageAlt,className:"d-inline-block align-center"})}):e.jsx("div",{className:"grid-item item-avatar",children:e.jsx("img",{src:j.avatarNotSpeakingIcon.imageSrc,alt:j.avatarNotSpeakingIcon.imageAlt,className:"d-inline-block align-center"})}),e.jsx("div",{className:"grid-item item-input-wrapper-menu-view",children:t?e.jsx("div",{className:"grid-item item-icon-load-alexa-loading-view",children:e.jsx("img",{src:j.loadingIcon.imageSrc,alt:j.loadingIcon.imageAlt,className:"d-inline-block align-center"})}):n?e.jsxs("div",{className:"grid-item item-waiting-text-alexa-loading-view item-waiting-text-alexa-loading-view-animation",children:["La palabra que he entendido es $",a,". Buscando palabra..."]}):e.jsxs(te,{size:"lg",className:"mb-3",children:[e.jsx(ne.Control,{placeholder:"\xBFEn qu\xE9 te puedo ayudar?","aria-label":"\xBFEn qu\xE9 te puedo ayudar?","aria-describedby":"basic-addon2"}),e.jsx(w,{id:"save-debug-btn",path:"",classStyle:"",type:"submit",children:"Enviar"})]})})]})})})})},Oe=()=>{const a={navBrand:{name:"Tu Amiga Virtual"},navBtns:[{name:"debug-btn",icon:Y,path:"/debug"}],disableNavButton:!1},t={icon:e.jsx(q,{icon:X,size:"lg"}),msg:"Ejemplo: Alexa, me siento solo"};return e.jsxs(e.Fragment,{children:[e.jsx(H,{navBrand:a.navBrand,navBtns:a.navBtns,disableNavButton:a.disableNavButton}),e.jsx(Te,{}),e.jsx(xe,{msg:t.msg,icon:t.icon})]})},De=()=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"container-fluid",children:e.jsx("div",{className:"container-menu-start-app-view",children:e.jsxs("div",{className:"grid-container-start-app-view",children:[e.jsx("div",{className:"item-logo-start-app-view",children:"Tu Amiga Virtual"}),e.jsx("div",{className:"item-button-start-app-view",children:e.jsx(w,{id:"start",path:"/dialog",classStyle:"btn-primary item-button",type:"button",children:"Comenzar"})})]})})})}),Pe=({msg:a})=>{const t={navBrand:{name:"En Modo Debug"},navBtns:[{name:"exit-btn",icon:Z,path:"/dialog"}],disableNavButton:!1};return e.jsxs(e.Fragment,{children:[e.jsx(H,{navBrand:t.navBrand,navBtns:t.navBtns,disableNavButton:t.disableNavButton}),e.jsx("div",{className:"debug-container",children:e.jsxs("div",{className:"debug-container-grid",children:[e.jsx("div",{className:"debug-container-grid-item-traza",children:e.jsx("ul",{children:a.map((i,n)=>i&&e.jsx("li",{children:i},n))})}),e.jsx("div",{className:"debug-container-grid-item-input-btns",children:e.jsx("div",{className:"debug-container-grid-item-input-field",children:e.jsxs("div",{className:"input-group mb-3",children:[e.jsx("div",{className:"input-group-prepend",children:e.jsx("span",{className:"input-group-text",id:"inputGroup-sizing-default",children:"UID"})}),e.jsx("input",{type:"number",name:"uid",placeholder:"UID del usuario que ha realizado test usabilidad",pattern:"^[0-9]+$",title:"Solo se permiten n\xFAmeros",className:"form-control","aria-label":"Default","aria-describedby":"inputGroup-sizing-default",required:!0})]})})})]})})]})},ke=()=>{const[a,t]=o.useState(null),[i,n]=o.useState([]),s=y(),c=o.useCallback(async()=>{u("Beginning Alexa.create"),window.Alexa?window.Alexa.create({version:"1.0"}).then(r=>{r.alexa?(t(r.alexa),r.alexa.skill.onMessage(x),r.alexa.speech.onStarted(N),r.alexa.speech.onStopped(k),r.alexa.voice.onMicrophoneOpened(E),r.alexa.voice.onMicrophoneClosed(f),u("Alexa is ready - newest version 5 :) Received initial data 45"),r.message.deviceId&&(u("Alexa Skill init data: "+r.message.deviceId),console.log("Alexa Skill init data: "+r.message.deviceId),s(je(r.message.deviceId))),s(O(h.OK))):(u(`Alexa failed to initialize, code: ${r.code}`),s(O(h.NOT_OK)))}).catch(r=>{u(`Alexa not ready :(. Error: ${r}`),s(O(h.NOT_OK))}):s(O(h.NOT_OK))},[]),d=r=>{n(g=>[...g,r]),console.log(r)},m=()=>{n([])},u=r=>{d(typeof r!="string"?JSON.stringify(r,null,2):r)},D=r=>{r.statusCode==200?u("message was sent to backend successfully"):(s(A(b.END_SPEECH)),u("failed to send message to skill backend:"))},P=o.useCallback(async r=>{try{u("sending message to skill endpoint ==> "+JSON.stringify(r)),u("+++ INSIDE sendMessage - alexaClient ==> "+a),await a.skill.sendMessage(r,D)}catch(g){s(A(b.END_SPEECH)),u("Alexa error ==> "+g)}},[a]),x=r=>{let g;u("Web APP received a message from the skill endpoint"),u(r),r&&(g={intentType:r.intentType,userRequest:r.userRequest},s(F(!0)),s(Ee(g)))},N=()=>{s(A(b.START_SPEECH))},k=()=>{s(A(b.END_SPEECH))},E=()=>{s($(T.MICROPHONE_OPENED))},f=()=>{s($(T.MICROPHONE_CLOSED))},C=o.useCallback(()=>{s(G())},[]);return o.useEffect(()=>{c()},[]),{debugMessages:i,printDebug:u,sendMessage:P,resetVoiceIntent:C,resetDebugMessages:m}},Ce=()=>{const a=y(),{debugMessages:t,printDebug:i,sendMessage:n,resetDebugMessages:s}=ke();return{debugMessages:t,printDebug:i,sendLogToAlexa:async(c,d)=>{c===h.OK&&await n({intentRequest:"log-text-intent",logTxt:d})},sendTextToAlexa:async(c,d,m)=>{c===h.OK&&(a(A(b.SEND_SPEECH)),await n({intentRequest:m||"text-to-speech-intent",speech:d}))},resetDebugMessages:s}},R=W.createContext({});function Me(){const{debugMessages:a,printDebug:t,sendLogToAlexa:i,sendTextToAlexa:n,resetDebugMessages:s}=Ce();return e.jsx(e.Fragment,{children:e.jsx(R.Provider,{value:{debugMessages:a,printDebug:t,sendLogToAlexa:i,sendTextToAlexa:n,resetDebugMessages:s},children:e.jsx(Q,{basename:I.BASE_ROUTE,children:e.jsxs(ae,{children:[e.jsx(M,{path:I.START_APP_ROUTE,element:e.jsx(De,{})}),e.jsx(M,{path:I.DIALOG_ROUTE,element:e.jsx(Oe,{})}),e.jsx(M,{path:I.DEBUG_ROUTE,element:e.jsx(Pe,{msg:a})})]})})})})}const we=ce({reducer:{voiceState:Ae}});J.createRoot(document.getElementById("root")).render(e.jsx(ie,{store:we,children:e.jsxs(e.Fragment,{children:[e.jsx(de,{}),e.jsx(Me,{})]})}));
